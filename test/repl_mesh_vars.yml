---
# Mesh replication test: 2 suppliers (rhds11, rhds13) and 2 consumers (rhds12, rhds14)

dirsrv_password: password
dirsrv_manage_service: false
dirsrv_instance: localhost
dirsrv_ldapi_socket_path: "/data/run/slapd-localhost.socket"
dirsrv_ldapi_uri: "ldapi://%2Fdata%2Frun%2Fslapd-localhost.socket"

dirsrv_repl_suffixes:
  - "o=example"

dirsrv_repl_nodes:
  rhds11: { role: supplier, instance: "localhost", host: "rhds11", port: 389, protocol: LDAP }
  rhds12: { role: consumer, instance: "localhost", host: "rhds12", port: 389, protocol: LDAP }
  rhds13: { role: supplier, instance: "localhost", host: "rhds13", port: 389, protocol: LDAP }
  rhds14: { role: consumer, instance: "localhost", host: "rhds14", port: 389, protocol: LDAP }

dirsrv_repl_replica_ids:
  "o=example":
    rhds11: 1
    rhds13: 2

dirsrv_repl_auth:
  method: SIMPLE
  bind_dn: "cn=Directory Manager"
  bind_password: "{{ dirsrv_password }}"

dirsrv_repl_agreements:
  "o=example":
    # Supplier-to-supplier (bi-directional), init from rhds11 to rhds13
    - { from: "rhds11", to: "rhds13", name: "s1-to-s2", init: true }
    - { from: "rhds13", to: "rhds11", name: "s2-to-s1", init: false }
    # Supplier-to-consumer
    - { from: "rhds11", to: "rhds12", name: "s1-to-c1", init: true }
    - { from: "rhds13", to: "rhds14", name: "s2-to-c2", init: true }

dirsrv_repl_set_release_timeout: false
dirsrv_repl_run_replcheck: false

